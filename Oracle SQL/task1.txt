SELECT d.department_name "department_name",
(CASE WHEN (COUNT(e.employee_id) > 0) THEN TO_CHAR(COUNT(e.employee_id))
      ELSE 'N/A' END) "emp_cnt",
(CASE WHEN (COUNT(DISTINCT e.job_id) > 0) THEN TO_CHAR(COUNT(DISTINCT e.job_id))
      ELSE 'N/A' END) "job_cnt",
(CASE WHEN (SUM(e.salary) > 0) THEN TO_CHAR(SUM(e.salary))
      ELSE 'N/A' END) "sum_sal",
(CASE WHEN (MAX(e.salary) + MIN(e.salary)) IS NOT NULL THEN TO_CHAR((MAX(e.salary) + MIN(e.salary)))
      ELSE 'N/A' END) "sum_min_max",
LISTAGG(e.phone_number, ', ') WITHIN GROUP (ORDER BY e.phone_number ASC) "phone_numbers"
FROM DEPARTMENTS d
LEFT JOIN EMPLOYEES e
ON d.department_id = e.department_id
JOIN LOCATIONS l
ON d.location_id = l.location_id
JOIN COUNTRIES c 
ON l.country_id = c.country_id
WHERE INSTR(TRIM(d.department_name), ' ') = 0
AND LOWER(c.country_name) LIKE (LOWER(c.country_id) || '%')
GROUP BY d.department_name, l.country_id, c.country_name
ORDER BY l.country_id ASC, c.country_name DESC;